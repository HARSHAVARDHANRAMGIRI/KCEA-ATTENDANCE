{% extends 'layout.html' %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-7 col-xl-6">
    <div class="card shadow-sm overflow-hidden">
      <div class="row g-0 align-items-center">
        <div class="col-md-5 p-4" style="background:linear-gradient(135deg,#1e40af,#dc2626);color:#fff;">
          <div class="text-center">
            <div style="width:80px;height:80px;background:linear-gradient(135deg,#1e40af,#dc2626);border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 25px rgba(30,64,175,0.5);margin:0 auto;border:4px solid rgba(255,255,255,0.3);">
              <span style="color:white;font-weight:800;font-size:20px;letter-spacing:2px;font-family:'Playfair Display',serif;text-shadow:0 2px 4px rgba(0,0,0,0.3);">KCEA</span>
            </div>
            <h4 class="mt-3 mb-1">KCEA Portal</h4>
            <div class="opacity-75">Smart Attendance • NAAC A • ISO 9001</div>
          </div>
        </div>
        <div class="col-md-7 p-4 bg-white">
          <h4 class="mb-3">Login</h4>
          <form method="post">
            <div class="mb-3">
              <label class="form-label">Roll No</label>
              <div class="input-group">
                <input name="roll_no" id="login_roll" class="form-control" placeholder="22B41A0501" required>
                <button class="btn btn-outline-secondary" type="button" onclick="requestLoginOtp()">Get OTP</button>
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label">OTP</label>
              <input name="otp" class="form-control" required>
            </div>
            <div class="d-flex justify-content-between align-items-center">
              <a href="/signup" class="btn btn-outline-secondary">Create account</a>
              <button class="btn btn-primary" type="submit">Login</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-5 d-none d-lg-block">
    <img src="https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
         class="img-fluid rounded"
         alt="KCEA Campus"
         onerror="this.src='https://via.placeholder.com/600x400/2563eb/ffffff?text=KCEA+Engineering+College'"
         style="max-height: 500px; object-fit: cover;">
  </div>
</div>
<script>
async function requestLoginOtp(){
  const roll = document.getElementById('login_roll').value.trim().toUpperCase();
  const form = new FormData();
  form.append('roll_no', roll);
  form.append('purpose', 'login');
  const res = await fetch('/request-otp', { method:'POST', body: form });
  const data = await res.json();
  if(data.ok){
    alert('Login OTP: ' + data.otp + ' (demo)');
  }else{
    alert(data.message || 'Failed to request OTP');
  }
}
</script>
{% endblock %}
